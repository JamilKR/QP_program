program QP_program
  !
  use QP_module
  use f95_lapack, only : la_syevr
  !
  implicit none
  !
  Character(len=100):: nm_file
  integer i
  !
  Namelist/HIL/ Ncon,Nval
  Namelist/POT/ a,b,c,d
  !
  read(*,*) nm_file
  !
  open(11,file=trim(nm_file),status='old',action='read')
  !
  read(11,HIL)
  read(11,POT)
  !
  close(11)
  !
  allocate(H(0:Ncon,0:Ncon),E(0:Ncon))
  !
  call Hamiltonian
  !
  E=0.0d0 !Initialized
  !
  call la_syevr(A=H, W=E, JOBZ='V', UPLO='U')
  !
  E=E-minval(E)
  !
  do i=0,Nval
     write(*,*) i,E(i)
  enddo
  !
end program QP_program
